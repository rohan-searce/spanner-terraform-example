FROM gcr.io/google.com/cloudsdktool/cloud-sdk:alpine
RUN gcloud config configurations create emulator \
  && gcloud config set auth/disable_credentials true \
  && gcloud config set project test-project \
  && gcloud config set api_endpoint_overrides/spanner gcloud config set api_endpoint_overrides/spanner http://34.82.51.50:9020/
ENV SPANNER_EMULATOR_HOST="34.82.51.50:9010"
RUN apk add --update nodejs npm
WORKDIR /usr/src/app
COPY package*.json ./
RUN npm install
COPY . ./
CMD [ "npm", "start" ]
